apiVersion: monitoring.coreos.com/v1
kind: ServiceMonitor
metadata:
  name: foodfund-microservices
  namespace: monitoring
  labels:
    app: foodfund-microservices
    prometheus: kube-prometheus
spec:
  selector:
    matchLabels:
      app.kubernetes.io/component: microservice
  endpoints:
  - port: metrics
    interval: 30s
    path: /metrics
    honorLabels: true
  namespaceSelector:
    matchNames:
    - default
    - foodfund
---
apiVersion: monitoring.coreos.com/v1
kind: ServiceMonitor
metadata:
  name: auth-service
  namespace: monitoring
  labels:
    app: auth-service
    prometheus: kube-prometheus
spec:
  selector:
    matchLabels:
      app: auth-service
  endpoints:
  - port: http
    interval: 30s
    path: /metrics
    honorLabels: true
  namespaceSelector:
    matchNames:
    - default
---
apiVersion: monitoring.coreos.com/v1
kind: ServiceMonitor
metadata:
  name: campaign-service
  namespace: monitoring
  labels:
    app: campaign-service
    prometheus: kube-prometheus
spec:
  selector:
    matchLabels:
      app: campaign-service
  endpoints:
  - port: http
    interval: 30s
    path: /metrics
    honorLabels: true
  namespaceSelector:
    matchNames:
    - default
---
apiVersion: monitoring.coreos.com/v1
kind: ServiceMonitor
metadata:
  name: user-service
  namespace: monitoring
  labels:
    app: user-service
    prometheus: kube-prometheus
spec:
  selector:
    matchLabels:
      app: user-service
  endpoints:
  - port: http
    interval: 30s
    path: /metrics
    honorLabels: true
  namespaceSelector:
    matchNames:
    - default
---
apiVersion: monitoring.coreos.com/v1
kind: ServiceMonitor
metadata:
  name: graphql-gateway
  namespace: monitoring
  labels:
    app: graphql-gateway
    prometheus: kube-prometheus
spec:
  selector:
    matchLabels:
      app: graphql-gateway
  endpoints:
  - port: http
    interval: 30s
    path: /metrics
    honorLabels: true
  namespaceSelector:
    matchNames:
    - default